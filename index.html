<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Semaphore Guesser</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .focus-style:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <div class="bg-white p-6 sm:p-8 rounded-2xl shadow-lg text-center max-w-md w-full">
        
        <h1 class="text-2xl sm:text-3xl font-bold text-gray-800 mb-2">Semaphore Signal Practice</h1>
        <p class="text-gray-500 mb-6">Get as many correct as you can before time runs out!</p>

        <!-- Timer Display -->
        <div class="mb-4 text-2xl font-bold text-gray-700">
            Time left: <span id="timer" class="text-red-500">2:00</span>
        </div>

        <!-- Semaphore Display -->
        <div class="bg-blue-50 rounded-lg p-4 mb-2 flex justify-center items-center h-48 sm:h-56">
            <svg id="semaphore-svg" width="150" height="150" viewBox="0 0 100 100">
                <!-- Figure Body -->
                <circle cx="50" cy="25" r="6" fill="#4A5568"/> <!-- Head -->
                <line x1="50" y1="31" x2="50" y2="65" stroke="#4A5568" stroke-width="5" stroke-linecap="round"/> <!-- Torso -->
                <line x1="50" y1="65" x2="40" y2="85" stroke="#4A5568" stroke-width="5" stroke-linecap="round"/> <!-- Left Leg -->
                <line x1="50" y1="65" x2="60" y2="85" stroke="#4A5568" stroke-width="5" stroke-linecap="round"/> <!-- Right Leg -->
                
                <!-- Semaphore Arms -->
                <!-- Right Arm (Red) -->
                <line id="upper_arm1" x1="50" y1="42" x2="50" y2="42" stroke="#F56565" stroke-width="6" stroke-linecap="round"/>
                <line id="forearm1" x1="50" y1="42" x2="50" y2="42" stroke="#F56565" stroke-width="6" stroke-linecap="round"/>
                <circle id="elbow1" cx="50" cy="42" r="2" fill="#F56565"/>
                
                <!-- Left Arm (Blue) -->
                <line id="upper_arm2" x1="50" y1="42" x2="50" y2="42" stroke="#4299E1" stroke-width="6" stroke-linecap="round"/>
                <line id="forearm2" x1="50" y1="42" x2="50" y2="42" stroke="#4299E1" stroke-width="6" stroke-linecap="round"/>
                <circle id="elbow2" cx="50" cy="42" r="2" fill="#4299E1"/>
            </svg>
        </div>
        
        <!-- Arm Legend -->
        <div class="text-sm text-gray-500 mb-6">
            <span class="font-semibold text-red-500">Red</span>: Figure's Right Hand | 
            <span class="font-semibold text-blue-500">Blue</span>: Figure's Left Hand
        </div>

        <!-- Input and Controls -->
        <div class="space-y-4">
            <input type="text" id="guess-input" maxlength="1" class="w-full p-4 text-2xl text-center border-2 border-gray-300 rounded-lg focus-style transition" placeholder="?">
            
            <p id="result-message" class="h-6 text-lg font-medium"></p>

            <button id="check-btn" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-105 focus-style">Check Answer</button>
            
            <button id="next-btn" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-105 focus-style hidden">Next Letter</button>
        </div>

        <!-- Score -->
        <div class="mt-6 text-gray-600 font-semibold text-lg">
            <p>Score: <span id="score" class="font-bold text-gray-800">0 / 0</span></p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DOM Elements ---
            const upper_arm1 = document.getElementById('upper_arm1');
            const forearm1 = document.getElementById('forearm1');
            const elbow1_dot = document.getElementById('elbow1');
            const upper_arm2 = document.getElementById('upper_arm2');
            const forearm2 = document.getElementById('forearm2');
            const elbow2_dot = document.getElementById('elbow2');
            
            const guessInput = document.getElementById('guess-input');
            const checkBtn = document.getElementById('check-btn');
            const nextBtn = document.getElementById('next-btn');
            const resultMessage = document.getElementById('result-message');
            const scoreDisplay = document.getElementById('score');

            // --- Semaphore Data ---
            const SEMAPHORE_ALPHABET = {
                'A': [225, 270], 'B': [180, 270], 'C': [135, 270], 'D': [90, 270],
                'E': [270, 45],  'F': [270, 0],   'G': [270, 315], 'H': [180, 225],
                'I': [135, 225], 'J': [90, 0],    'K': [225, 90],  'L': [225, 45],
                'M': [225, 0],   'N': [225, 315], 'O': [135, 180], 'P': [180, 90],
                'Q': [180, 45],  'R': [180, 0],   'S': [180, 315], 'T': [135, 90],
                'U': [135, 45],  'V': [90, 315],  'W': [0, 45],    'X': [45, 315],
                'Y': [135, 0],   'Z': [315, 0]
            };
            const letters = Object.keys(SEMAPHORE_ALPHABET);

            // --- State ---
            let currentLetter = '';
            let score = 0;
            let total = 0;
            let countdownInterval;

            // --- Timer Functions ---
            function startGameTimer() {
                let remaining = 120; // 2 minutes
                updateTimerDisplay(remaining);

                countdownInterval = setInterval(() => {
                    remaining--;
                    updateTimerDisplay(remaining);

                    if (remaining <= 0) {
                        clearInterval(countdownInterval);
                        endGame();
                    }
                }, 1000);
            }

            function updateTimerDisplay(seconds) {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                document.getElementById('timer').textContent = 
                    `${mins}:${secs.toString().padStart(2, '0')}`;
            }

            function endGame() {
                guessInput.disabled = true;
                checkBtn.disabled = true;
                nextBtn.disabled = true;
                resultMessage.textContent = `â° Time's up! Final score: ${score} / ${total}`;
                resultMessage.className = 'h-6 text-lg font-medium text-blue-600';
            }

            // --- Drawing Function ---
            function drawSemaphore(letter) {
                if (!SEMAPHORE_ALPHABET[letter]) return;
                const [angle1, angle2] = SEMAPHORE_ALPHABET[letter];
                const upperArmLength = 17.5;
                const forearmLength = 17.5;
                const shoulderX = 50;
                const shoulderY = 42;
                const rad1 = -angle1 * Math.PI / 180;
                const rad2 = -angle2 * Math.PI / 180;

                // Right arm
                const elbowX1 = shoulderX + upperArmLength * Math.cos(rad1);
                const elbowY1 = shoulderY + upperArmLength * Math.sin(rad1);
                const handX1 = elbowX1 + forearmLength * Math.cos(rad1);
                const handY1 = elbowY1 + forearmLength * Math.sin(rad1);
                upper_arm1.setAttribute('x2', elbowX1);
                upper_arm1.setAttribute('y2', elbowY1);
                forearm1.setAttribute('x1', elbowX1);
                forearm1.setAttribute('y1', elbowY1);
                forearm1.setAttribute('x2', handX1);
                forearm1.setAttribute('y2', handY1);
                elbow1_dot.setAttribute('cx', elbowX1);
                elbow1_dot.setAttribute('cy', elbowY1);

                // Left arm
                const elbowX2 = shoulderX + upperArmLength * Math.cos(rad2);
                const elbowY2 = shoulderY + upperArmLength * Math.sin(rad2);
                const handX2 = elbowX2 + forearmLength * Math.cos(rad2);
                const handY2 = elbowY2 + forearmLength * Math.sin(rad2);
                upper_arm2.setAttribute('x2', elbowX2);
                upper_arm2.setAttribute('y2', elbowY2);
                forearm2.setAttribute('x1', elbowX2);
                forearm2.setAttribute('y1', elbowY2);
                forearm2.setAttribute('x2', handX2);
                forearm2.setAttribute('y2', handY2);
                elbow2_dot.setAttribute('cx', elbowX2);
                elbow2_dot.setAttribute('cy', elbowY2);
            }

            // --- Challenge Functions ---
            function newChallenge() {
                currentLetter = letters[Math.floor(Math.random() * letters.length)];
                drawSemaphore(currentLetter);
                resultMessage.textContent = '';
                resultMessage.className = 'h-6 text-lg font-medium';
                guessInput.value = '';
                guessInput.disabled = false;
                guessInput.focus();
                checkBtn.classList.remove('hidden');
                nextBtn.classList.add('hidden');
            }

            function checkAnswer() {
                const userAnswer = guessInput.value.toUpperCase();
                if (!userAnswer) {
                    resultMessage.textContent = 'Please enter a letter.';
                    resultMessage.className = 'h-6 text-lg font-medium text-yellow-600';
                    return;
                }
                total++;
                if (userAnswer === currentLetter) {
                    score++;
                    resultMessage.textContent = 'Correct!';
                    resultMessage.className = 'h-6 text-lg font-medium text-green-600';
                } else {
                    resultMessage.textContent = `Wrong! The answer was '${currentLetter}'.`;
                    resultMessage.className = 'h-6 text-lg font-medium text-red-600';
                }
                scoreDisplay.textContent = `${score} / ${total}`;
                guessInput.disabled = true;
                checkBtn.classList.add('hidden');
                nextBtn.classList.remove('hidden');
                nextBtn.focus();
            }

            // --- Event Listeners ---
            checkBtn.addEventListener('click', checkAnswer);
            nextBtn.addEventListener('click', newChallenge);
            guessInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault(); 
                    if (!checkBtn.classList.contains('hidden')) {
                        checkAnswer();
                    }
                }
            });

            // --- Initial Load ---
            newChallenge();
            startGameTimer();
        });
    </script>
</body>
</html>
